<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//sqlmap.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="PerformData">

    <resultMap id="performData" type="PerformData">
        <result property="id" column="id"/>
        <result property="context" column="context"/>
        <result property="type" column="type"/>
        <result property="metaId" column="meta_id"/>
        <result property="addTime" column="add_time"/>
    </resultMap>

    <sql id="selector">
        SELECT
        id,context,type,meta_id,add_time
        FROM perform_data
    </sql>

    <sql id="where">
        <trim prefix="WHERE" prefixOverrides="AND | OR">
            <if test="id != null">AND id = #{id}</if>
            <if test="context != null">AND context = #{context}</if>
            <if test="type != null">AND type = #{type}</if>
            <if test="metaId != null">AND meta_id = #{metaId}</if>
            <if test="addTime != null">AND add_time = #{addTime}</if>
        </trim>
    </sql>

    <!-- 使用order by 字段要取消mybatis的预编译功能，会导致注入，需要用户把控输入输出 -->
    <sql id="orderBy">
        <trim prefix="ORDER BY">
            <if test="orderFields != null">
                <foreach item="item" collection="orderFields" separator=",">
                    ${item.orderBy} ${item.desc}
                </foreach>
            </if>
        </trim>
    </sql>

    <sql id="limit">
        <trim prefix=" LIMIT ">
            <if test="startRow != null">#{startRow},#{pageSize}</if>
        </trim>
    </sql>

    <insert id="insertPerformData" parameterType="performData">
        INSERT INTO perform_data
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">id,</if>
            <if test="context != null">context,</if>
            <if test="type != null">type,</if>
            <if test="metaId != null">meta_id,</if>
            <if test="addTime != null">add_time,</if>
        </trim>
        VALUES
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="id != null">#{id},</if>
            <if test="context != null">#{context},</if>
            <if test="type != null">#{type},</if>
            <if test="metaId != null">#{metaId},</if>
            <if test="addTime != null">#{addTime},</if>
        </trim>
    </insert>

    <insert id="batchInsertPerformData" parameterType="list">
        <foreach item="item" collection="list" separator="">
            INSERT INTO perform_data
            <trim prefix="(" suffix=")" suffixOverrides=",">
                <if test="item.id != null">id,</if>
                <if test="item.context != null">context,</if>
                <if test="item.type != null">type,</if>
                <if test="item.metaId != null">meta_id,</if>
                <if test="item.addTime != null">add_time,</if>
            </trim>
            VALUES
            (
            <trim suffixOverrides=",">
                <if test="item.id != null">#{item.id},</if>
                <if test="item.context != null">#{item.context},</if>
                <if test="item.type != null">#{item.type},</if>
                <if test="item.metaId != null">#{item.metaId},</if>
                <if test="item.addTime != null">#{item.addTime},</if>
            </trim>
            );
        </foreach>
    </insert>

    <update id="updatePerformDataByKey" parameterType="performData">
        UPDATE perform_data
        <trim prefix="SET" prefixOverrides="," suffixOverrides=",">
            <if test="id != null">id = #{id},</if>
            <if test="context != null">context = #{context},</if>
            <if test="type != null">type = #{type},</if>
            <if test="metaId != null">meta_id = #{metaId},</if>
            <if test="addTime != null">add_time = #{addTime},</if>
        </trim>
        WHERE
        id = #{id}
    </update>

    <update id="batchUpdatePerformData" parameterType="list">
        <foreach collection="list" item="item" index="index" close=";" separator=";">
            UPDATE perform_data
            <trim prefix="SET" prefixOverrides="," suffixOverrides=",">
                <if test="item.id != null">id = #{item.id},</if>
                <if test="item.context != null">context = #{item.context},</if>
                <if test="item.type != null">type = #{item.type},</if>
                <if test="item.metaId != null">meta_id = #{item.metaId},</if>
                <if test="item.addTime != null">add_time = #{item.addTime},</if>
            </trim>
            WHERE id = #{item.id}
        </foreach>
    </update>

    <!-- 默认的主键类型是integer -->
    <delete id="deletePerformDataByKey" parameterType="integer">
        DELETE FROM perform_data WHERE id = #{key}
    </delete>

    <delete id="batchDeletePerformData" parameterType="list">
        DELETE FROM perform_data WHERE id IN
        <foreach collection="list" item="item" open="(" close=")" separator=",">
            #{item}
        </foreach>
    </delete>

    <select id="getPerformDataWithPerformDataQuery" parameterType="performDataQuery" resultMap="performData">
        <include refid="selector"/>
        <include refid="where"/>
        <include refid="orderBy"/>
    </select>

    <select id="getPerformDataWithPage" parameterType="performDataQuery" resultMap="performData">
        <include refid="selector"/>
        <include refid="where"/>
        <include refid="orderBy"/>
        <include refid="limit"/>
    </select>

    <select id="selectPerformDataByKey" resultMap="performData" parameterType="integer">
        <include refid="selector"/>
        WHERE id = #{key}
    </select>
</mapper>
